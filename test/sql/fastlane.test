# name: test/sql/fastlane.test
# description: test fastlane extension
# group: [fastlane]

# Require statement will ensure this test is run with this extension loaded
require fastlane

# Test version function
query T
SELECT fastlane_version();
----
FastLanes Extension v1.0.0

# Test scan_fastlanes function with non-existent file (should throw error)
statement error
SELECT * FROM scan_fastlanes('nonexistent.fls') LIMIT 0;
----
Failed to open FastLanes file: nonexistent.fls

# Test COPY TO functionality with simple data
statement ok
COPY (SELECT 42 as foofy, 'string' as stringy) TO "test.fls" (FORMAT FLS);

# Test reading the file we just created
query I
SELECT foofy FROM scan_fastlanes('test.fls');
----
42
